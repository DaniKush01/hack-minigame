<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hacking Phone – Hard Mode</title>
  <style>
    body{
      margin:0;
      background:#020617;
      color:#22c55e;
      font-family:monospace;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
    }
    .phone{
      width:380px; max-width:95vw;
      border:2px solid #22c55e;
      border-radius:20px;
      padding:14px;
      box-shadow:0 0 25px rgba(34,197,94,.25);
      background:#020617;
    }
    h1{ text-align:center; font-size:1.1rem; margin:6px 0 10px; }
    .log{
      font-size:.8rem;
      border:1px solid #14532d;
      padding:8px; margin-bottom:8px;
      min-height:48px;
    }
    .grid{
      display:grid; grid-template-columns:repeat(4,1fr);
      gap:6px; margin:10px 0;
    }
    .node{
      border:1px solid #14532d;
      padding:10px 0; text-align:center;
      cursor:pointer; user-select:none;
    }
    .node.ok{ background:#14532d; }
    .node.bad{ background:#7f1d1d; color:#fecaca; }
    .hidden{ display:none; }
    .cipher{ font-size:.85rem; margin:8px 0; }
    .btn{
      border:1px solid #14532d; background:#020617; color:#22c55e;
      padding:8px 10px; cursor:pointer; margin:4px 2px;
    }
    .chat{ border:1px solid #14532d; padding:6px; margin:6px 0; cursor:pointer; }
    .msg{ border-top:1px solid #14532d; margin-top:8px; padding-top:8px; font-size:.9rem; }
  </style>
</head>
<body>
  <div class="phone">
    <h1 id="title">Firewall – Checksum</h1>

    <!-- Fase 1 -->
    <div id="fase1">
      <div class="log">> Individua la sequenza corretta dei nodi (ordine crescente).</div>
      <div class="grid" id="grid"></div>
      <div class="log" id="seq">Sequenza: </div>
    </div>

    <!-- Fase 2 -->
    <div id="fase2" class="hidden">
      <div class="log">> Payload cifrato rilevato. Hint: Shift -3</div>
      <div class="cipher">QEB NRFZH YOLTK CLU GRJMP LSBO QEB IXWV ALD</div>
      <button class="btn" onclick="decifra(false)">Decripta (Shift -1)</button>
      <button class="btn" onclick="decifra(true)">Decripta (Shift -3)</button>
      <div class="log" id="decLog"></div>
    </div>

    <!-- Fase 3 -->
    <div id="fase3" class="hidden">
      <h1>Messaggi</h1>
      <div class="chat" onclick="openChat(1)">Collega</div>
      <div class="chat" onclick="openChat(2)">Gruppo Lavoro</div>
      <div class="chat" onclick="openChat(3)">Tecnico IT</div>
      <div class="chat" onclick="openChat(4)">Banca</div>
      <div class="chat" onclick="openChat(5)">Amico</div>
      <div id="chatView" class="msg hidden"></div>
    </div>
  </div>

<script>
  // Fase 1
  const numbers = [3,12,7,1,14,6,10,4,9,2,16,5,11,8,15,13];
  let current = 1;
  const grid = document.getElementById("grid");
  const seq = document.getElementById("seq");

  numbers.forEach(n=>{
    const d = document.createElement("div");
    d.className = "node";
    d.innerText = n;
    d.onclick = ()=>{
      if(n === current){
        d.classList.add("ok");
        seq.innerText += n + " ";
        current++;
        if(current > 6){
          document.getElementById("fase1").classList.add("hidden");
          document.getElementById("fase2").classList.remove("hidden");
          document.getElementById("title").innerText = "Decrittazione Payload";
        }
      } else {
        d.classList.add("bad");
        setTimeout(()=>d.classList.remove("bad"),300);
        current = 1;
        seq.innerText = "Sequenza: ";
      }
    };
    grid.appendChild(d);
  });

  // Fase 2
  function decifra(ok){
    const log = document.getElementById("decLog");
    if(ok){
      log.innerText = "> Decrittazione riuscita. Accesso al dispositivo.";
      setTimeout(()=>{
        document.getElementById("fase2").classList.add("hidden");
        document.getElementById("fase3").classList.remove("hidden");
        document.getElementById("title").innerText = "Dispositivo compromesso";
      },800);
    } else {
      log.innerText = "> Decrittazione fallita. Riprova.";
    }
  }

  // Fase 3
  function openChat(id){
    const v = document.getElementById("chatView");
    v.classList.remove("hidden");
    if(id === 4){
      v.innerHTML = "<strong>Banca</strong><br><br>Codice tastierino di oggi:<br><span style='font-size:1.2rem'>7392</span>";
    } else {
      v.innerHTML = "Conversazione non rilevante.";
    }
  }
</script>
</body>
</html>
